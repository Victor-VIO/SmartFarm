{% extends "base.html" %}

{% block title %}{{ mentor.full_name or mentor.username }} - SmartFarm Training Hub{% endblock %}

{% block content %}

<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- Mentor Header -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-8">
        <div class="bg-gradient-to-r from-green-400 to-green-600 h-32"></div>
        
        <div class="px-8 py-6 -mt-16 relative">
            <div class="flex flex-col md:flex-row md:items-end md:space-x-6">
                <!-- Avatar -->
                <div class="bg-green-100 dark:bg-green-900 w-32 h-32 rounded-full flex items-center justify-center border-4 border-white dark:border-gray-800 mb-4 md:mb-0">
                    <i class="fas fa-user-circle text-green-600 dark:text-green-400 text-7xl"></i>
                </div>
                
                <!-- Info -->
                <div class="flex-1">
                    <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-2">
                        {{ mentor.full_name or mentor.username }}
                    </h1>
                    <p class="text-green-600 dark:text-green-400 text-lg font-bold mb-2">
                        <i class="fas fa-leaf mr-2"></i>{{ mentor.expertise or 'Agriculture Expert' }}
                    </p>
                    <p class="text-gray-600 dark:text-gray-300">{{ mentor.bio or 'Experienced agriculture professional.' }}</p>
                </div>
                <!-- Action Button -->
            <div class="mt-6 md:mt-0">
              {% if current_user.is_authenticated and current_user.id != mentor.id %}
                  {% if request_status == 'pending' %}
                      <button disabled class="w-full md:w-auto bg-yellow-500 text-white px-8 py-3 rounded-lg font-bold">
                          <i class="fas fa-clock mr-2"></i> Request Pending
                      </button>
                  {% elif request_status == 'accepted' %}
                      <a href="{{ url_for('mentorship.chat', mentor_id=mentor.id) }}" class="inline-block w-full md:w-auto bg-green-600 text-white px-8 py-3 rounded-lg hover:bg-green-700 transition font-bold text-center">
                          <i class="fas fa-comments mr-2"></i> Message
                      </a>
                  {% elif request_status == 'rejected' %}
                      <button disabled class="w-full md:w-auto bg-red-500 text-white px-8 py-3 rounded-lg font-bold">
                          <i class="fas fa-times mr-2"></i> Request Rejected
                      </button>
                  {% else %}
                      <button onclick="openRequestModal()" class="w-full md:w-auto bg-green-600 text-white px-8 py-3 rounded-lg hover:bg-green-700 transition font-bold">
                          <i class="fas fa-handshake mr-2"></i> Request Mentorship
                      </button>
                  {% endif %}
              {% elif not current_user.is_authenticated %}
                  <a href="{{ url_for('auth.register') }}" class="inline-block w-full md:w-auto bg-green-600 text-white px-8 py-3 rounded-lg hover:bg-green-700 transition font-bold text-center">
                      <i class="fas fa-user-plus mr-2"></i> Sign Up
                  </a>
              {% endif %}
          </div>
      </div>
  </div>
</div>

<!-- Bio Section -->
<div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 mb-8">
  <h2 class="text-2xl font-bold mb-4 text-gray-900 dark:text-white">About the Mentor</h2>
  <p class="text-gray-600 dark:text-gray-300 leading-relaxed">
      {{ mentor.bio or 'This mentor specializes in agriculture and is ready to guide you through your learning journey.' }}
  </p>
</div>

<!-- Expertise Section -->
<div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8">
  <h2 class="text-2xl font-bold mb-4 text-gray-900 dark:text-white">Expertise</h2>
  <div class="flex flex-wrap gap-3">
      <span class="bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-4 py-2 rounded-full">
          {{ mentor.expertise or 'General Agriculture' }}
      </span>
  </div>
</div>
</div>
<!-- Request Mentorship Modal -->
<div id="requestModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-md w-full mx-4">
        <div class="px-8 py-6">
            <h2 class="text-2xl font-bold mb-4 text-gray-900 dark:text-white">Request Mentorship</h2>
            <form method="POST" action="{{ url_for('mentorship.request_mentorship', mentor_id=mentor.id) }}">
              <div class="mb-4">
                  <label class="block text-sm font-bold text-gray-900 dark:text-white mb-2">Message (Optional)</label>
                  <textarea name="message" rows="4" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-green-500"></textarea>
              </div>
              
              <div class="flex space-x-4">
                  <button type="submit" class="flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition font-bold">
                      Send Request
                  </button>
                  <button type="button" onclick="closeRequestModal()" class="flex-1 bg-gray-300 dark:bg-gray-700 text-gray-900 dark:text-white py-2 rounded-lg hover:bg-gray-400 transition font-bold">
                      Cancel
                  </button>
              </div>
          </form>
      </div>
  </div>
</div>
<script>
    function openRequestModal() {
        document.getElementById('requestModal').classList.remove('hidden');
    }
    
    function closeRequestModal() {
        document.getElementById('requestModal').classList.add('hidden');
    }
</script>
{% endblock %}